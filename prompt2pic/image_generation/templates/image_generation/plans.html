<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Plans - Prompt2Pic</title>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@latest/dist/full.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <style>
        /* Enhanced Background */
        body {
            background: linear-gradient(135deg, #6b7280, #ec4899, #3b82f6);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Card Styling */
        .plan-card {
            position: relative;
            transition: transform 0.4s ease, box-shadow 0.4s ease;
            overflow: hidden;
            border-radius: 1rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .plan-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.25);
        }

        /* Card Glow Effect */
        .plan-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(99, 102, 241, 0.2) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.5s ease;
            pointer-events: none;
        }

        .plan-card:hover::before {
            opacity: 1;
        }

        /* Animated Icons */
        .benefit-icon {
            font-size: 2.5rem;
            color: #6366f1;
            transition: transform 0.3s ease;
        }

        .plan-card:hover .benefit-icon {
            transform: scale(1.2) rotate(10deg);
        }

        /* Button Animation */
        .btn-primary {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .btn-primary::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .btn-primary:hover::after {
            width: 200%;
            height: 200%;
        }

        /* Title Animation */
        .title-anim {
            animation: fadeInDown 1s ease-out;
        }

        @keyframes fadeInDown {
            0% { opacity: 0; transform: translateY(-20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        /* Why Choose Us Section */
        .why-choose-us {
            background: rgba(255, 255, 255, 0.1);
            padding: 2rem;
            border-radius: 1rem;
            backdrop-filter: blur(10px);
            animation: fadeInUp 1s ease-out;
        }

        @keyframes fadeInUp {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center">
    <div class="container mx-auto px-4 py-12">
        <h1 class="text-5xl font-extrabold text-white text-center mb-12 title-anim">Choose Your Plan</h1>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-10 justify-items-center">
            <!-- Weekly Plan -->
            <div class="card plan-card shadow-2xl p-8 text-center">
                <h2 class="text-3xl font-bold text-primary mb-2">Weekly Plan</h2>
                <p class="text-xl text-gray-700 font-semibold">$5</p>
                <div class="flex items-center mb-6 justify-center">
                    <i class="fas fa-clock benefit-icon"></i>
                    <p class="ml-3 text-gray-600">Perfect for short-term projects!</p>
                </div>
                <button class="btn btn-primary btn-lg mt-4" onclick="pay('weekly')">Subscribe Now</button>
            </div>
            <!-- Monthly Plan -->
            <div class="card plan-card shadow-2xl p-8 text-center">
                <h2 class="text-3xl font-bold text-primary mb-2">Monthly Plan</h2>
                <p class="text-xl text-gray-700 font-semibold">$15</p>
                <div class="flex items-center mb-6 justify-center">
                    <i class="fas fa-calendar-alt benefit-icon"></i>
                    <p class="ml-3 text-gray-600">Ideal for ongoing projects!</p>
                </div>
                <button class="btn btn-primary btn-lg mt-4" onclick="pay('monthly')">Subscribe Now</button>
            </div>
            <!-- Annual Plan -->
            <div class="card plan-card shadow-2xl p-8 text-center">
                <h2 class="text-3xl font-bold text-primary mb-2">Annual Plan</h2>
                <p class="text-xl text-gray-700 font-semibold">$99</p>
                <div class="flex items-center mb-6 justify-center">
                    <i class="fas fa-star benefit-icon"></i>
                    <p class="ml-3 text-gray-600">Best value for long-term users!</p>
                </div>
                <button class="btn btn-primary btn-lg mt-4" onclick="pay('annual')">Subscribe Now</button>
            </div>
        </div>
        <div class="mt-12 text-center text-white why-choose-us">
            <h2 class="text-3xl font-bold">Why Choose Us?</h2>
            <p class="mt-4 text-lg">Unlock premium features and enhance your creative experience with our advanced AI models!</p>
        </div>
    </div>
    <script src="https://js.stripe.com/v3/"></script>
    <script>
        // Initialize Stripe with your publishable key
        const stripe = Stripe('pk_test_51QwSWdL05RboHoHG5RrbmE7bO8vE6hU8wG8YpZJqQe5XvYvL8vXvYvL8vXvYvL8vXvYvL8vXvYvL8vXvYvL8'); // Replace with your actual Stripe Publishable Key
    
        // Function to handle payment
        function pay(plan) {
            // Show a loading state (optional)
            const button = event.target;
            button.disabled = true;
            button.textContent = 'Processing...';
    
            // Make a POST request to your backend to create a Checkout Session
            fetch('/image/create-payment-intent/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    // Include CSRF token if CSRF protection is enforced
                    'X-CSRFToken': getCookie('csrftoken'),
                },
                body: JSON.stringify({ plan: plan }),
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                if (data.error) {
                    console.error('Error from server:', data.error);
                    alert('Something went wrong. Please try again.');
                    button.disabled = false;
                    button.textContent = 'Subscribe Now';
                } else {
                    // Redirect to Stripe Checkout
                    return stripe.redirectToCheckout({ sessionId: data.id });
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred. Please try again later.');
                button.disabled = false;
                button.textContent = 'Subscribe Now';
            });
        }
    
        // Helper function to get CSRF token from cookies (required for Django POST requests)
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
    </script>
</body>
</html>